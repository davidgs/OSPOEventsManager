# OSPO Events Manager - Local Development Environment Configuration
# Extracted from dev-rh-events-org cluster on 2025-09-17
# CONFIGURED TO CONNECT TO CLUSTER SERVICES FROM LOCAL LAPTOP
# RENAME THIS FILE TO .env AFTER REVIEW
# DO NOT commit the .env file to git - it contains secrets

# =============================================================================
# SAFETY CONFIGURATION
# =============================================================================

# DANGER: Keycloak realm override (CAN DELETE ALL USERS!)
# Set to 'true' ONLY if you want to risk deleting all Keycloak users
# This should NEVER be set to 'true' in production!
KEYCLOAK_OVERRIDE_REALM=false

# =============================================================================
# DOCKER HUB CONFIGURATION (Optional - for rate limit avoidance)
# =============================================================================

# Docker Hub credentials to avoid rate limiting
# Get a token from: https://hub.docker.com/settings/security
DOCKERHUB_USERNAME=your_dockerhub_username
DOCKERHUB_TOKEN=your_dockerhub_token
DOCKERHUB_EMAIL=your_email@example.com

# =============================================================================
# DATABASE CONFIGURATION - CONNECTING TO CLUSTER
# =============================================================================

# PostgreSQL Configuration (extracted from cluster)
POSTGRES_DB=ospo_events
POSTGRES_USER=ospo_user
POSTGRES_PASSWORD=1MG4zWUea3Ee1cv07BNlCLpU05drZbYJ

# Connect to cluster PostgreSQL via port forwarding
# Run: oc port-forward svc/postgres 5432:5432
DATABASE_URL=postgresql://ospo_user:1MG4zWUea3Ee1cv07BNlCLpU05drZbYJ@localhost:5432/ospo_events

# Individual PostgreSQL Connection Details (for direct psql access via port-forward)
PGUSER=ospo_user
PGHOST=localhost
PGPASSWORD=1MG4zWUea3Ee1cv07BNlCLpU05drZbYJ
PGDATABASE=ospo_events
PGPORT=5432

# PgAdmin Configuration (for development/debugging)
PGADMIN_DEFAULT_EMAIL=admin@ospo.example.com
PGADMIN_DEFAULT_PASSWORD=admin_password_here

# =============================================================================
# KEYCLOAK CONFIGURATION - CONNECTING TO CLUSTER
# =============================================================================

# Keycloak Admin Credentials (extracted from cluster)
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=Tm-xYL0B6Zl_WiICRJhzepGH5FY

# Keycloak Database Configuration (extracted from cluster)
KEYCLOAK_DB_HOST=localhost
KEYCLOAK_DB_PORT=5432
KEYCLOAK_DB_NAME=keycloak
KEYCLOAK_DB_USER=keycloak_user
KEYCLOAK_DB_PASSWORD=JVzqLGiacouQ_8CK4cRMjigGiqprEhxl

# Keycloak URLs - Use cluster external URLs
KEYCLOAK_URL=https://keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com/auth/
KEYCLOAK_SERVER_URL=https://keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com
KEYCLOAK_CLIENT_URL=https://keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com/auth
KEYCLOAK_REALM=ospo-events
KEYCLOAK_CLIENT_ID=ospo-events-app
# Note: Client is configured as public client, no secret needed
KEYCLOAK_CLIENT_SECRET=

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Node.js Environment (set to development for local)
NODE_ENV=development

# Application Port (your local app will run on this port)
PORT=4576

# Application Secrets (extracted from cluster)
JWT_SECRET=f155995da618d4152575b17d089d99c8374461aa44caed05b5ffa369f3b34351
SESSION_SECRET=your-session-secret-here-min-32-chars

# =============================================================================
# MINIO (OBJECT STORAGE) CONFIGURATION - CONNECTING TO CLUSTER
# =============================================================================

# MinIO Configuration - Connect to cluster MinIO via port forwarding
# Run: oc port-forward svc/minio 9000:9000
MINIO_ROOT_USER=ospo-minio-admin
MINIO_ROOT_PASSWORD=CJWa7bQ2QvRjEk8hF3mLzNxPyU6tGsVw
MINIO_BUCKET_NAME=ospo-uploads
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=ospo-minio-admin
MINIO_SECRET_KEY=CJWa7bQ2QvRjEk8hF3mLzNxPyU6tGsVw
MINIO_BUCKET=ospo-uploads

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================

# Environment type: dev or prod
ENVIRONMENT=dev

# OpenShift Configuration (extracted from cluster)
OPENSHIFT_SERVER=https://api.ospo-osci.z3b1.p1.openshiftapps.com:6443
OPENSHIFT_TOKEN=sha256~fp2Fvq-6mk6kEDb8eokFc7JKm3aMbb1EJz_Eduv17x4
CLUSTER_DOMAIN=apps.ospo-osci.z3b1.p1.openshiftapps.com

# Namespace Configuration
DEV_NAMESPACE=dev-rh-events-org
PROD_NAMESPACE=prod-rh-events-org

# Application URLs (extracted from cluster routes)
DEV_APP_URL=https://ospo-app-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com
PROD_APP_URL=https://ospo-app-prod-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com

# Keycloak URLs (extracted from cluster routes)
DEV_KEYCLOAK_URL=https://keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com
PROD_KEYCLOAK_URL=https://keycloak-prod-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com

# Frontend Keycloak URLs (used by Vite during build)
VITE_KEYCLOAK_URL_DEV=https://keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com/auth
VITE_KEYCLOAK_URL_PROD=https://keycloak-prod-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com/auth
VITE_KEYCLOAK_URL=https://keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com/auth

# =============================================================================
# RESOURCE LIMITS (OpenShift Deployment)
# =============================================================================

# PostgreSQL Resources
POSTGRES_CPU_REQUEST=100m
POSTGRES_CPU_LIMIT=500m
POSTGRES_MEMORY_REQUEST=256Mi
POSTGRES_MEMORY_LIMIT=512Mi

# Keycloak Resources
KEYCLOAK_CPU_REQUEST=200m
KEYCLOAK_CPU_LIMIT=1000m
KEYCLOAK_MEMORY_REQUEST=512Mi
KEYCLOAK_MEMORY_LIMIT=1Gi

# Application Resources
APP_CPU_REQUEST=100m
APP_CPU_LIMIT=500m
APP_MEMORY_REQUEST=256Mi
APP_MEMORY_LIMIT=512Mi

# Minio Resources
MINIO_CPU_REQUEST=100m
MINIO_CPU_LIMIT=500m
MINIO_MEMORY_REQUEST=256Mi
MINIO_MEMORY_LIMIT=512Mi

# =============================================================================
# SESSION CONFIGURATION (extracted from cluster)
# =============================================================================

# Session Management
SESSION_RESAVE=false
SESSION_SAVE_UNINITIALIZED=false
SESSION_SECURE=false
SESSION_HTTP_ONLY=true
SESSION_MAX_AGE=86400000
SESSION_SAME_SITE=lax
SESSION_NAME=ospo.sid

# =============================================================================
# RATE LIMITING CONFIGURATION (extracted from cluster)
# =============================================================================

# Rate Limiting Settings
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=100
RATE_LIMIT_MESSAGE=Too many requests from this IP, please try again later.
RATE_LIMIT_RETRY_AFTER=900
RATE_LIMIT_STANDARD_HEADERS=true
RATE_LIMIT_LEGACY_HEADERS=false
RATE_LIMIT_SKIP_PATHS=/api/health,/api/version

# =============================================================================
# SECURITY HEADERS (HELMET/CSP) (extracted from cluster)
# =============================================================================

# Content Security Policy
CSP_STYLE_SRC=https://fonts.googleapis.com
CSP_SCRIPT_SRC=
CSP_IMG_SRC=
CSP_CONNECT_SRC=
CSP_FONT_SRC=https://fonts.gstatic.com
CSP_OBJECT_SRC='none'
CSP_MEDIA_SRC=
CSP_FRAME_SRC=

# Helmet Security Headers
HELMET_COEP=false
HELMET_HSTS_MAX_AGE=31536000
HELMET_HSTS_INCLUDE_SUBDOMAINS=true
HELMET_HSTS_PRELOAD=true

# =============================================================================
# PROXY CONFIGURATION (extracted from cluster)
# =============================================================================

# Proxy Settings (for local development connecting to cluster)
PROXY_FORWARDED_HOST=localhost:4576
PROXY_FORWARDED_PROTO=http
PROXY_FORWARDED_PORT=4576
PROXY_REDIRECT_PATTERN=localhost/auth
PROXY_REDIRECT_REPLACEMENT=keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com/auth
PROXY_TIMEOUT_MS=10000

# =============================================================================
# LOCAL DEVELOPMENT SETUP INSTRUCTIONS
# =============================================================================
#
# This configuration connects your local development environment to the
# OpenShift cluster services. To set this up:
#
# 1. REQUIRED PORT FORWARDS:
#    Run these commands in separate terminals to connect to cluster services:
#
#    # PostgreSQL database
#    oc port-forward svc/postgres 5432:5432
#
#    # MinIO object storage
#    oc port-forward svc/minio 9000:9000
#
# 2. KEYCLOAK:
#    Uses the external cluster URL directly (no port-forward needed)
#    https://keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com
#
# 3. START YOUR LOCAL APP:
#    npm run dev
#    # Your app will run on http://localhost:4576
#
# 4. AUTHENTICATION FLOW:
#    - Your local app (localhost:4576) will redirect users to cluster Keycloak
#    - Users authenticate with cluster Keycloak
#    - Keycloak redirects back to your local app
#    - Your local app connects to cluster database via port-forward
#
# This setup gives you:
# ✅ Local development with hot reload
# ✅ Real cluster data and users
# ✅ Real authentication flow
# ✅ Shared storage with the cluster
#
# Security reminder: This file contains production secrets from your dev cluster.
# Keep it secure and never commit it to version control.
#
