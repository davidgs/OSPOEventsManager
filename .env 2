# OSPO Events Manager - Environment Configuration Template
# Copy this file to .env and fill in your values
# DO NOT commit the .env file to git - it contains secrets

# =============================================================================
# SAFETY CONFIGURATION
# =============================================================================

# DANGER: Keycloak realm override (CAN DELETE ALL USERS!)
# Set to 'true' ONLY if you want to risk deleting all Keycloak users
# This should NEVER be set to 'true' in production!
KEYCLOAK_OVERRIDE_REALM=false

# =============================================================================
# DOCKER HUB CONFIGURATION (Optional - for rate limit avoidance)
# =============================================================================

# Docker Hub credentials to avoid rate limiting
# Get a token from: https://hub.docker.com/settings/security
DOCKERHUB_USERNAME=your_dockerhub_username
DOCKERHUB_TOKEN=your_dockerhub_token
DOCKERHUB_EMAIL=your_email@example.com

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Configuration
POSTGRES_DB=ospo_events
POSTGRES_USER=ospo_user
POSTGRES_PASSWORD=secure_password_here

# Full PostgreSQL Connection String (auto-constructed from above values)
DATABASE_URL=postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# Individual PostgreSQL Connection Details (for direct psql access)
PGUSER=${POSTGRES_USER}
PGHOST=postgres
PGPASSWORD=${POSTGRES_PASSWORD}
PGDATABASE=${POSTGRES_DB}
PGPORT=5432

# PgAdmin Configuration (for development/debugging)
PGADMIN_DEFAULT_EMAIL=admin@ospo.example.com
PGADMIN_DEFAULT_PASSWORD=admin_password_here

# =============================================================================
# KEYCLOAK CONFIGURATION
# =============================================================================

# Keycloak Admin Credentials
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin_password_here

# Keycloak Database Configuration
KEYCLOAK_DB_HOST=postgres
KEYCLOAK_DB_PORT=5432
KEYCLOAK_DB_NAME=keycloak
KEYCLOAK_DB_USER=keycloak_user
KEYCLOAK_DB_PASSWORD=keycloak_db_password_here

# Keycloak Realm Configuration
KEYCLOAK_URL=http://keycloak:8080/auth/
KEYCLOAK_REALM=ospo-events
KEYCLOAK_CLIENT_ID=ospo-events-app
KEYCLOAK_CLIENT_SECRET=your-client-secret-here

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Node.js Environment
NODE_ENV=production

# Application Port
PORT=5000

# Application Secrets
JWT_SECRET=your-jwt-secret-here-min-32-chars
SESSION_SECRET=your-session-secret-here-min-32-chars

# =============================================================================
# MINIO (OBJECT STORAGE) CONFIGURATION
# =============================================================================

MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minio_password_here
MINIO_BUCKET_NAME=ospo-uploads

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================

# Environment type: dev or prod
ENVIRONMENT=dev

# OpenShift Configuration (for deployment)
OPENSHIFT_SERVER=https://api.ospo-osci.z3b1.p1.openshiftapps.com:6443
OPENSHIFT_TOKEN=your-openshift-token-here
CLUSTER_DOMAIN=apps.ospo-osci.z3b1.p1.openshiftapps.com

# Namespace Configuration
DEV_NAMESPACE=dev-rh-events-org
PROD_NAMESPACE=prod-rh-events-org

# Application URLs (environment-specific)
DEV_APP_URL=https://ospo-app-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com
PROD_APP_URL=https://ospo-app-prod-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com

# Keycloak URLs (environment-specific)
DEV_KEYCLOAK_URL=https://keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com
PROD_KEYCLOAK_URL=https://keycloak-prod-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com

# Frontend Keycloak URLs (used by Vite during build)
VITE_KEYCLOAK_URL_DEV=https://keycloak-dev-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com/auth
VITE_KEYCLOAK_URL_PROD=https://keycloak-prod-rh-events-org.apps.ospo-osci.z3b1.p1.openshiftapps.com/auth

# =============================================================================
# RESOURCE LIMITS (OpenShift Deployment)
# =============================================================================

# PostgreSQL Resources
POSTGRES_CPU_REQUEST=100m
POSTGRES_CPU_LIMIT=500m
POSTGRES_MEMORY_REQUEST=256Mi
POSTGRES_MEMORY_LIMIT=512Mi

# Keycloak Resources
KEYCLOAK_CPU_REQUEST=200m
KEYCLOAK_CPU_LIMIT=1000m
KEYCLOAK_MEMORY_REQUEST=512Mi
KEYCLOAK_MEMORY_LIMIT=1Gi

# Application Resources
APP_CPU_REQUEST=100m
APP_CPU_LIMIT=500m
APP_MEMORY_REQUEST=256Mi
APP_MEMORY_LIMIT=512Mi

# Minio Resources
MINIO_CPU_REQUEST=100m
MINIO_CPU_LIMIT=500m
MINIO_MEMORY_REQUEST=256Mi
MINIO_MEMORY_LIMIT=512Mi

# =============================================================================
# USAGE NOTES
# =============================================================================
#
# 1. Copy this file to .env: cp .env.template .env
# 2. Replace all placeholder values with your actual values
# 3. Generate secure passwords for all *_PASSWORD fields
# 4. Get OpenShift token from: oc whoami --show-token
# 5. Update URLs if deploying to different OpenShift cluster
# 6. For local development, you may need to adjust host names and ports
# 7. Never commit .env file to git - it contains secrets!
#
# Required placeholders to replace:
# - secure_password_here
# - admin_password_here
# - keycloak_db_password_here
# - your-client-secret-here
# - your-jwt-secret-here-min-32-chars
# - your-session-secret-here-min-32-chars
# - minio_password_here
# - your-openshift-token-here
#
# Example secure password generation:
# openssl rand -base64 32
#
# Example JWT/Session secret generation:
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#

# =============================================================================
# SESSION CONFIGURATION
# =============================================================================

# Session Management
SESSION_SECRET=your-session-secret-here-min-32-chars
SESSION_RESAVE=false
SESSION_SAVE_UNINITIALIZED=false
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_MAX_AGE=86400000
SESSION_SAME_SITE=lax
SESSION_NAME=ospo.sid

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================

# Rate Limiting Settings
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=100
RATE_LIMIT_MESSAGE='Too many requests from this IP, please try again later.'
RATE_LIMIT_RETRY_AFTER=900
RATE_LIMIT_STANDARD_HEADERS=true
RATE_LIMIT_LEGACY_HEADERS=false
RATE_LIMIT_SKIP_PATHS=/api/health,/api/version

# =============================================================================
# SECURITY HEADERS (HELMET/CSP)
# =============================================================================

# Content Security Policy
CSP_STYLE_SRC=https://fonts.googleapis.com
CSP_SCRIPT_SRC=
CSP_IMG_SRC=
CSP_CONNECT_SRC=
CSP_FONT_SRC=https://fonts.gstatic.com
CSP_OBJECT_SRC='none'
CSP_MEDIA_SRC=
CSP_FRAME_SRC=

# Helmet Security Headers
HELMET_COEP=false
HELMET_HSTS_MAX_AGE=31536000
HELMET_HSTS_INCLUDE_SUBDOMAINS=true
HELMET_HSTS_PRELOAD=true

# =============================================================================
# PROXY CONFIGURATION
# =============================================================================

# Proxy Settings
PROXY_FORWARDED_HOST=
PROXY_FORWARDED_PROTO=http
PROXY_FORWARDED_PORT=
PROXY_REDIRECT_PATTERN=localhost/auth
PROXY_REDIRECT_REPLACEMENT=
PROXY_TIMEOUT_MS=10000

